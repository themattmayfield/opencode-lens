{"version":3,"file":"UniversalRenderer.js","names":["frameId: null | number"],"sources":["../src/UniversalRenderer.ts"],"sourcesContent":["type Callback = (time: number) => unknown;\n\nconst queuedCallbacks = new Set<Callback>();\nlet callbacks = new Set<Callback>();\nlet frameId: null | number = null;\nlet isRendering = false;\n\n// TODO(amadeus): Figure out a proper name for this module...\nexport function queueRender(callback: Callback): void {\n  if (isRendering) {\n    queuedCallbacks.add(callback);\n    return;\n  }\n  callbacks.add(callback);\n  frameId ??= requestAnimationFrame(render);\n}\n\nfunction render(time: number): void {\n  isRendering = true;\n  for (const callback of callbacks) {\n    try {\n      callback(time);\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  callbacks.clear();\n  if (queuedCallbacks.size > 0) {\n    callbacks = new Set(queuedCallbacks);\n    queuedCallbacks.clear();\n    frameId = requestAnimationFrame(render);\n  } else {\n    frameId = null;\n  }\n  isRendering = false;\n}\n"],"mappings":";AAEA,MAAM,kCAAkB,IAAI,KAAe;AAC3C,IAAI,4BAAY,IAAI,KAAe;AACnC,IAAIA,UAAyB;AAC7B,IAAI,cAAc;AAGlB,SAAgB,YAAY,UAA0B;AACpD,KAAI,aAAa;AACf,kBAAgB,IAAI,SAAS;AAC7B;;AAEF,WAAU,IAAI,SAAS;AACvB,aAAY,sBAAsB,OAAO;;AAG3C,SAAS,OAAO,MAAoB;AAClC,eAAc;AACd,MAAK,MAAM,YAAY,UACrB,KAAI;AACF,WAAS,KAAK;UACP,OAAO;AACd,UAAQ,MAAM,MAAM;;AAGxB,WAAU,OAAO;AACjB,KAAI,gBAAgB,OAAO,GAAG;AAC5B,cAAY,IAAI,IAAI,gBAAgB;AACpC,kBAAgB,OAAO;AACvB,YAAU,sBAAsB,OAAO;OAEvC,WAAU;AAEZ,eAAc"}