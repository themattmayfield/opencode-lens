{"version":3,"file":"html_render_utils.js","names":[],"sources":["../../src/utils/html_render_utils.ts"],"sourcesContent":["import { getTokenStyleObject, stringifyTokenStyle } from 'shiki';\nimport { DEFAULT_THEMES } from 'src/constants';\n\nimport type {\n  PJSHighlighter,\n  PJSThemeNames,\n  ThemeTypes,\n  ThemedToken,\n  ThemesType,\n} from '../types';\nimport { getHighlighterThemeStyles } from './getHighlighterThemeStyles';\n\nexport function createSpanFromToken(token: ThemedToken): HTMLSpanElement {\n  const element = document.createElement('span');\n  const style = token.htmlStyle ?? getTokenStyleObject(token);\n  element.style = stringifyTokenStyle(style);\n  element.textContent = token.content;\n  return element;\n}\n\nexport function createRow(line: number): {\n  row: HTMLElement;\n  content: HTMLElement;\n} {\n  const row = document.createElement('div');\n  row.dataset.line = `${line}`;\n\n  const lineColumn = document.createElement('div');\n  lineColumn.dataset.columnNumber = '';\n  lineColumn.textContent = `${line}`;\n\n  const content = document.createElement('div');\n  content.dataset.columnContent = '';\n\n  row.appendChild(lineColumn);\n  row.appendChild(content);\n  return { row, content };\n}\n\ninterface SetupWrapperNodesProps {\n  theme?: PJSThemeNames | ThemesType;\n  pre: HTMLPreElement;\n  highlighter: PJSHighlighter;\n  split: boolean;\n  wrap: boolean;\n  themeType: ThemeTypes;\n  diffIndicators: 'bars' | 'classic' | 'none';\n  disableBackground: boolean;\n  totalLines: number;\n}\n\ninterface CreateCodeNodeProps {\n  pre?: HTMLPreElement;\n  columnType?: 'additions' | 'deletions' | 'unified';\n}\n\nexport function createCodeNode({\n  pre,\n  columnType,\n}: CreateCodeNodeProps = {}): HTMLElement {\n  const code = document.createElement('code');\n  code.dataset.code = '';\n  if (columnType != null) {\n    code.dataset[columnType] = '';\n  }\n  pre?.appendChild(code);\n  return code;\n}\n\nexport function setWrapperProps({\n  pre,\n  highlighter,\n  theme = DEFAULT_THEMES,\n  split,\n  wrap,\n  themeType,\n  diffIndicators,\n  disableBackground,\n  totalLines,\n}: SetupWrapperNodesProps): HTMLPreElement {\n  // Get theme color custom properties (e.g., --pjs-fg, --pjs-bg)\n  const styles = getHighlighterThemeStyles({ theme, highlighter });\n\n  if (themeType === 'system') {\n    delete pre.dataset.themeType;\n  } else {\n    pre.dataset.themeType = themeType;\n  }\n  if (typeof theme === 'string') {\n    const themeData = highlighter.getTheme(theme);\n    pre.dataset.themeType = themeData.type;\n  }\n  switch (diffIndicators) {\n    case 'bars':\n    case 'classic':\n      pre.dataset.indicators = diffIndicators;\n      break;\n    case 'none':\n      delete pre.dataset.indicators;\n      break;\n  }\n  if (disableBackground) {\n    delete pre.dataset.background;\n  } else {\n    pre.dataset.background = '';\n  }\n  pre.dataset.type = split ? 'split' : 'file';\n  pre.dataset.overflow = wrap ? 'wrap' : 'scroll';\n  pre.dataset.pjs = '';\n  pre.tabIndex = 0;\n  // Set theme color custom properties as inline styles on pre element\n  pre.style = styles;\n  // Set CSS custom property for line number column width\n  pre.style.setProperty(\n    '--pjs-min-number-column-width-default',\n    `${`${totalLines}`.length}ch`\n  );\n  return pre;\n}\n"],"mappings":";;;;;AAYA,SAAgB,oBAAoB,OAAqC;CACvE,MAAM,UAAU,SAAS,cAAc,OAAO;AAE9C,SAAQ,QAAQ,oBADF,MAAM,aAAa,oBAAoB,MAAM,CACjB;AAC1C,SAAQ,cAAc,MAAM;AAC5B,QAAO;;AAGT,SAAgB,UAAU,MAGxB;CACA,MAAM,MAAM,SAAS,cAAc,MAAM;AACzC,KAAI,QAAQ,OAAO,GAAG;CAEtB,MAAM,aAAa,SAAS,cAAc,MAAM;AAChD,YAAW,QAAQ,eAAe;AAClC,YAAW,cAAc,GAAG;CAE5B,MAAM,UAAU,SAAS,cAAc,MAAM;AAC7C,SAAQ,QAAQ,gBAAgB;AAEhC,KAAI,YAAY,WAAW;AAC3B,KAAI,YAAY,QAAQ;AACxB,QAAO;EAAE;EAAK;EAAS;;AAoBzB,SAAgB,eAAe,EAC7B,KACA,eACuB,EAAE,EAAe;CACxC,MAAM,OAAO,SAAS,cAAc,OAAO;AAC3C,MAAK,QAAQ,OAAO;AACpB,KAAI,cAAc,KAChB,MAAK,QAAQ,cAAc;AAE7B,MAAK,YAAY,KAAK;AACtB,QAAO;;AAGT,SAAgB,gBAAgB,EAC9B,KACA,aACA,QAAQ,gBACR,OACA,MACA,WACA,gBACA,mBACA,cACyC;CAEzC,MAAM,SAAS,0BAA0B;EAAE;EAAO;EAAa,CAAC;AAEhE,KAAI,cAAc,SAChB,QAAO,IAAI,QAAQ;KAEnB,KAAI,QAAQ,YAAY;AAE1B,KAAI,OAAO,UAAU,UAAU;EAC7B,MAAM,YAAY,YAAY,SAAS,MAAM;AAC7C,MAAI,QAAQ,YAAY,UAAU;;AAEpC,SAAQ,gBAAR;EACE,KAAK;EACL,KAAK;AACH,OAAI,QAAQ,aAAa;AACzB;EACF,KAAK;AACH,UAAO,IAAI,QAAQ;AACnB;;AAEJ,KAAI,kBACF,QAAO,IAAI,QAAQ;KAEnB,KAAI,QAAQ,aAAa;AAE3B,KAAI,QAAQ,OAAO,QAAQ,UAAU;AACrC,KAAI,QAAQ,WAAW,OAAO,SAAS;AACvC,KAAI,QAAQ,MAAM;AAClB,KAAI,WAAW;AAEf,KAAI,QAAQ;AAEZ,KAAI,MAAM,YACR,yCACA,GAAG,GAAG,aAAa,OAAO,IAC3B;AACD,QAAO"}