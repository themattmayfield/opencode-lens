{"version":3,"file":"PatchDiff.js","names":[],"sources":["../../src/react/PatchDiff.tsx"],"sourcesContent":["'use client';\n\nimport { useMemo } from 'react';\n\nimport type { FileDiffMetadata } from '../types';\nimport { parsePatchFiles } from '../utils/parsePatchFiles';\nimport type { DiffBasePropsReact } from './types';\nimport { renderAnnotationChildren } from './utils/renderAnnotationChildren';\nimport { templateRender } from './utils/templateRender';\nimport { useFileDiffInstance } from './utils/useFileDiffInstance';\n\nexport interface PatchDiffProps<LAnnotation>\n  extends DiffBasePropsReact<LAnnotation> {\n  patch: string;\n}\n\nexport function PatchDiff<LAnnotation = undefined>({\n  patch,\n  options,\n  lineAnnotations,\n  className,\n  style,\n  prerenderedHTML,\n  renderAnnotation,\n  renderHeaderMetadata,\n}: PatchDiffProps<LAnnotation>): React.JSX.Element {\n  const fileDiff = usePatch(patch);\n  const ref = useFileDiffInstance({ fileDiff, options, lineAnnotations });\n  const children = renderAnnotationChildren({\n    fileDiff,\n    renderHeaderMetadata,\n    renderAnnotation,\n    lineAnnotations,\n  });\n  return (\n    <file-diff ref={ref} className={className} style={style}>\n      {templateRender(children, prerenderedHTML)}\n    </file-diff>\n  );\n}\n\nfunction usePatch(patch: string): FileDiffMetadata {\n  return useMemo<FileDiffMetadata>(() => {\n    const parsedPatches = parsePatchFiles(patch);\n    if (parsedPatches.length !== 1) {\n      console.error(parsedPatches);\n      throw new Error(\n        'PatchDiff: Provided patch must include only 1 patch, with 1 diff'\n      );\n    }\n    const { files } = parsedPatches[0];\n    if (files.length !== 1) {\n      console.error(files);\n      throw new Error(\n        'FileDiff: Provided patch must contain exactly 1 file diff'\n      );\n    }\n    return files[0];\n  }, [patch]);\n}\n"],"mappings":";;;;;;;;;;;AAgBA,SAAgB,UAAmC,EACjD,OACA,SACA,iBACA,WACA,OACA,iBACA,kBACA,wBACiD;CACjD,MAAM,WAAW,SAAS,MAAM;AAQhC,QACE,oBAAC;EAAU,KARD,oBAAoB;GAAE;GAAU;GAAS;GAAiB,CAAC;EAQrC;EAAkB;YAC/C,eARY,yBAAyB;GACxC;GACA;GACA;GACA;GACD,CAAC,EAG4B,gBAAgB;GAChC;;AAIhB,SAAS,SAAS,OAAiC;AACjD,QAAO,cAAgC;EACrC,MAAM,gBAAgB,gBAAgB,MAAM;AAC5C,MAAI,cAAc,WAAW,GAAG;AAC9B,WAAQ,MAAM,cAAc;AAC5B,SAAM,IAAI,MACR,mEACD;;EAEH,MAAM,EAAE,UAAU,cAAc;AAChC,MAAI,MAAM,WAAW,GAAG;AACtB,WAAQ,MAAM,MAAM;AACpB,SAAM,IAAI,MACR,4DACD;;AAEH,SAAO,MAAM;IACZ,CAAC,MAAM,CAAC"}