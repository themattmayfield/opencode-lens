'use client';


import { parsePatchFiles } from "../utils/parsePatchFiles.js";
import { templateRender } from "./utils/templateRender.js";
import { renderAnnotationChildren } from "./utils/renderAnnotationChildren.js";
import { useFileDiffInstance } from "./utils/useFileDiffInstance.js";
import { useMemo } from "react";
import { jsx } from "react/jsx-runtime";

//#region src/react/PatchDiff.tsx
function PatchDiff({ patch, options, lineAnnotations, className, style, prerenderedHTML, renderAnnotation, renderHeaderMetadata }) {
	const fileDiff = usePatch(patch);
	return /* @__PURE__ */ jsx("file-diff", {
		ref: useFileDiffInstance({
			fileDiff,
			options,
			lineAnnotations
		}),
		className,
		style,
		children: templateRender(renderAnnotationChildren({
			fileDiff,
			renderHeaderMetadata,
			renderAnnotation,
			lineAnnotations
		}), prerenderedHTML)
	});
}
function usePatch(patch) {
	return useMemo(() => {
		const parsedPatches = parsePatchFiles(patch);
		if (parsedPatches.length !== 1) {
			console.error(parsedPatches);
			throw new Error("PatchDiff: Provided patch must include only 1 patch, with 1 diff");
		}
		const { files } = parsedPatches[0];
		if (files.length !== 1) {
			console.error(files);
			throw new Error("FileDiff: Provided patch must contain exactly 1 file diff");
		}
		return files[0];
	}, [patch]);
}

//#endregion
export { PatchDiff };
//# sourceMappingURL=PatchDiff.js.map