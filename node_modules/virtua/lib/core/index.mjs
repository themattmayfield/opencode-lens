const e=null,{min:t,max:o,abs:r,floor:n}=Math,s=(e,r,n)=>t(n,o(r,e)),c=e=>[...e].sort(((e,t)=>e-t)),i="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)},l=e=>{let t;return()=>(e&&(t=e(),e=void 0),t)},f=-1,a=(e,t,o)=>{const r=o?"unshift":"push";for(let o=0;o<t;o++)e[r](f);return e},u=(e,t)=>{const o=e.t[t];return o===f?e.o:o},d=(e,o,r)=>{const n=e.t[o]===f;return e.t[o]=r,e.i=t(o,e.i),n},$=(e,t)=>{if(!e.l)return 0;if(e.i>=t)return e.u[t];e.i<0&&(e.u[0]=0,e.i=0);let o=e.i,r=e.u[o];for(;o<t;)r+=u(e,o),e.u[++o]=r;return e.i=t,r},h=(e,t,o=0,r=e.l-1)=>{for(;o<=r;){const s=n((o+r)/2),c=$(e,s);if(c<=t){if(c+u(e,s)>t)return s;o=s+1}else r=s-1}return s(o,0,e.l-1)},p=(e,o,r)=>{const n=o-e.l;return e.i=r?-1:t(o-1,e.i),e.l=o,n>0?(a(e.u,n),a(e.t,n,r),e.o*n):(e.u.splice(n),(r?e.t.splice(0,-n):e.t.splice(n)).reduce(((t,o)=>t-(o===f?e.o:o)),0))},m="undefined"!=typeof window,w=()=>document.documentElement,g=e=>e.ownerDocument,v=e=>e.defaultView,b=/*#__PURE__*/l((()=>!!m&&"rtl"===getComputedStyle(w()).direction)),S=/*#__PURE__*/l((()=>/iP(hone|od|ad)/.test(navigator.userAgent))),I=/*#__PURE__*/l((()=>"scrollBehavior"in w().style)),y=5,k=6,x=1,_=4,z=8,T=e=>o(e.$getTotalSize(),e.$getViewportSize()),R=e=>!!e.$getViewportSize(),M=(n,s=40,i=4,l=0,m,w=!1)=>{let g=!!l,v=1,b=0,I=0,y=0,k=0,x=0,_=0,z=0,T=0,R=g?[0,o(l-1,0)]:e,M=[0,0],J=0;const P=((e,r,n)=>({o:n?n[1]:r,t:n&&n[0]?a(n[0].slice(0,t(e,n[0].length)),o(0,e-n[0].length)):a([],e),l:e,i:-1,u:a([],e)}))(n,s,m),W=new Set,B=()=>y-I,C=()=>B()+x+k,L=e=>((e,o,r,n)=>{if(n=t(n,e.l-1),$(e,n)<=o){const t=h(e,o+r,n);return[h(e,o,n,t),t]}{const t=h(e,o,void 0,n);return[t,h(e,o+r,t)]}})(P,e,b,M[0]),O=()=>(e=>e.l?$(e,e.l-1)+u(e,e.l-1):0)(P),q=e=>$(P,e)-x,U=e=>u(P,e),V=e=>{e&&(S()&&0!==z?x+=e:k+=e)};return{$getStateVersion:()=>v,$getCacheSnapshot:()=>(e=>[e.t.slice(),e.o])(P),$getRange:()=>{let e,r;return _?[e,r]=M:([e,r]=M=L(o(0,C())),R&&(e=t(e,R[0]),r=o(r,R[1]))),1!==z&&(e-=o(0,i)),2!==z&&(r+=o(0,i)),[o(e,0),t(r,P.l-1)]},$findStartIndex:()=>h(P,C()),$findEndIndex:()=>h(P,C()+b),$isUnmeasuredItem:e=>P.t[e]===f,$:()=>!!R&&P.t.slice(o(0,R[0]-1),t(P.l-1,R[1]+1)+1).includes(f),$getItemOffset:q,$getItemSize:U,$getItemsLength:()=>P.l,$getScrollOffset:()=>y,$isScrolling:()=>0!==z,$getViewportSize:()=>b,$getStartSpacerSize:()=>I,$getTotalSize:O,h:()=>(_=k,k=0,[_,2===T||B()+b>=O()]),$subscribe:(e,t)=>{const o=[e,t];return W.add(o),()=>{W.delete(o)}},$update:(t,n)=>{let s,i,l=0;switch(t){case 1:{const t=_;_=0;const o=n-y,s=r(o);t&&s<r(t)+1||0!==T||(z=o<0?2:1),g&&(R=e,g=!1),y=n,l=4;const c=B();c>=-b&&c<=O()&&(l+=1,i=s>b);break}case 2:l=8,0!==z&&(s=!0,l+=1),z=0,T=0,R=e;break;case 3:{const e=n.filter((([e,t])=>P.t[e]!==t));if(!e.length)break;V(e.reduce(((e,[t,o])=>((2===T||(R?!g&&t<R[0]:q(t)+(0===z&&0===T?U(t):0)<B()))&&(e+=o-U(t)),e)),0));for(const[t,o]of e){const e=U(t),r=d(P,t,o);w&&(J+=r?o:o-e)}w&&b&&J>b&&(V(((e,t)=>{let r=0;const n=[];e.t.forEach(((e,o)=>{e!==f&&(n.push(e),o<t&&r++)})),e.i=-1;const s=c(n),i=s.length,l=i/2|0,a=i%2==0?(s[l-1]+s[l])/2:s[l],u=e.o;return((e.o=a)-u)*o(t-r,0)})(P,h(P,C()))),w=!1),l=3,i=!0;break}case 4:b!==n&&(b=n,l=3);break;case 5:n[1]?(V(p(P,n[0],!0)),T=2,l=1):(p(P,n[0]),l=1);break;case 6:I=n;break;case 7:T=1;break;case 8:R=L(n),l=1}l&&(v=1+(2147483647&v),s&&x&&(k+=x,x=0),W.forEach((([e,t])=>{l&e&&t(i)})))}}},J=setTimeout,P=(e,t)=>t&&b()?-e:e,W=(t,o,r,n,s,c)=>{const i=Date.now;let l=0,f=!1,a=!1,u=!1,d=!1;const $=(()=>{let o;const r=()=>{o!=e&&clearTimeout(o)},n=()=>{r(),o=J((()=>{o=e,(()=>{if(f||a)return f=!1,void $();u=!1,t.$update(2)})()}),150)};return n.p=r,n})(),h=()=>{l=i(),u&&(d=!0),c&&t.$update(6,c()),t.$update(1,n()),$()},p=e=>{if(f||!t.$isScrolling()||e.ctrlKey)return;const o=i()-l;150>o&&50<o&&(r?e.deltaX:e.deltaY)&&(f=!0)},m=()=>{a=!0,u=d=!1},w=()=>{a=!1,S()&&(u=!0)};return o.addEventListener("scroll",h),o.addEventListener("wheel",p,{passive:!0}),o.addEventListener("touchstart",m,{passive:!0}),o.addEventListener("touchend",w,{passive:!0}),{m:()=>{o.removeEventListener("scroll",h),o.removeEventListener("wheel",p),o.removeEventListener("touchstart",m),o.removeEventListener("touchend",w),$.p()},v:()=>{const[e,o]=t.h();e&&(s(P(e,r),o,d),d=!1,o&&t.$getViewportSize()>t.$getTotalSize()&&t.$update(1,n()))}}},B=(e,t)=>{let o,r,n;const c=t?"scrollLeft":"scrollTop",l=t?"overflowX":"overflowY",f=async(r,s)=>{if(!o)return void i((()=>f(r,s)));n&&n();const l=()=>{let t;return[new Promise(((o,r)=>{t=o,n=r,R(e)&&J(r,150)})),e.$subscribe(2,(()=>{t&&t()}))]};if(s&&I()){for(;e.$update(8,r()),e.$();){const[e,t]=l();try{await e}catch(e){return}finally{t()}}o.scrollTo({[t?"left":"top"]:P(r(),t),behavior:"smooth"})}else for(;;){const[n,s]=l();try{o[c]=P(r(),t),e.$update(7),await n}catch(e){return}finally{s()}}};return{$observe(s){o=s,r=W(e,s,t,(()=>P(s[c],t)),((t,o,r)=>{if(r){const e=s.style,t=e[l];e[l]="hidden",J((()=>{e[l]=t}))}o?(s[c]=e.$getScrollOffset()+t,n&&n()):s[c]+=t}))},$dispose(){r&&r.m()},$scrollTo(e){f((()=>e))},$scrollBy(t){t+=e.$getScrollOffset(),f((()=>t))},$scrollToIndex(t,{align:o,smooth:r,offset:n=0}={}){if(t=s(t,0,e.$getItemsLength()-1),"nearest"===o){const r=e.$getItemOffset(t),n=e.$getScrollOffset();if(r<n)o="start";else{if(!(r+e.$getItemSize(t)>n+e.$getViewportSize()))return;o="end"}}f((()=>n+e.$getStartSpacerSize()+e.$getItemOffset(t)+("end"===o?e.$getItemSize(t)-e.$getViewportSize():"center"===o?(e.$getItemSize(t)-e.$getViewportSize())/2:0)),r)},$fixScrollJump:()=>{r&&r.v()}}},C=(e,t)=>{let o,r,n;const c=(e,t,o,r,n=0)=>{const s=r?"offsetLeft":"offsetTop",i=n+(r&&b()?o.innerWidth-e[s]-e.offsetWidth:e[s]),l=e.offsetParent;return e!==t&&l?c(l,t,o,r,i):i},l=async(r,s)=>{if(!o)return void i((()=>l(r,s)));n&&n();const c=()=>{let t;return[new Promise(((o,r)=>{t=o,n=r,R(e)&&J(r,150)})),e.$subscribe(2,(()=>{t&&t()}))]},f=v(g(o));if(s&&I()){for(;e.$update(8,r()),e.$();){const[e,t]=c();try{await e}catch(e){return}finally{t()}}f.scroll({[t?"left":"top"]:P(r(),t),behavior:"smooth"})}else for(;;){const[o,n]=c();try{f.scroll({[t?"left":"top"]:P(r(),t)}),e.$update(7),await o}catch(e){return}finally{n()}}};return{$observe(n){o=n;const s=t?"scrollX":"scrollY",i=g(n),l=v(i),f=i.body;r=W(e,l,t,(()=>P(l[s],t)),((o,r)=>{r?l.scroll({[t?"left":"top"]:e.$getScrollOffset()+o}):l.scrollBy(t?o:0,t?0:o)}),(()=>c(n,f,l,t)))},$dispose(){r&&r.m(),o=void 0},$fixScrollJump:()=>{r&&r.v()},$scrollToIndex(r,{align:n,smooth:i,offset:f=0}={}){if(!o)return;if(r=s(r,0,e.$getItemsLength()-1),"nearest"===n){const t=e.$getItemOffset(r),o=e.$getScrollOffset();if(t<o)n="start";else{if(!(t+e.$getItemSize(r)>o+e.$getViewportSize()))return;n="end"}}const a=g(o),u=v(a),d=a.documentElement,$=()=>e.$getViewportSize()-(t?d.clientWidth:d.clientHeight);l((()=>f+c(o,a.body,u,t)+e.$getItemOffset(r)+("end"===n?e.$getItemSize(r)-(e.$getViewportSize()-$()):"center"===n?(e.$getItemSize(r)-(e.$getViewportSize()-$()))/2:0)),i)}}},L=(e,t)=>{const o=B(e,!1),r=B(t,!0);return{$observe(e){o.$observe(e),r.$observe(e)},$dispose(){o.$dispose(),r.$dispose()},$scrollTo(e,t){o.$scrollTo(t),r.$scrollTo(e)},$scrollBy(e,t){o.$scrollBy(t),r.$scrollBy(e)},$scrollToIndex(e,t){o.$scrollToIndex(t),r.$scrollToIndex(e)},$fixScrollJump(){o.$fixScrollJump(),r.$fixScrollJump()}}},O=e=>{let t;return{S(o){(t||(t=new(v(g(o)).ResizeObserver)(e))).observe(o)},I(e){t.unobserve(e)},m(){t&&t.disconnect()}}},q=(t,o)=>{let r;const n=o?"width":"height",s=new WeakMap,c=O((o=>{const c=[];for(const{target:i,contentRect:l}of o)if(i.offsetParent)if(i===r)t.$update(4,l[n]);else{const t=s.get(i);t!=e&&c.push([t,l[n]])}c.length&&t.$update(3,c)}));return{$observeRoot(e){c.S(r=e)},$observeItem:(e,t)=>(s.set(e,t),c.S(e),()=>{s.delete(e),c.I(e)}),$dispose:c.m}},U=(t,o)=>{const r=o?"width":"height",n=o?"innerWidth":"innerHeight",s=new WeakMap,c=O((o=>{const n=[];for(const{target:t,contentRect:c}of o){if(!t.offsetParent)continue;const o=s.get(t);o!=e&&n.push([o,c[r]])}n.length&&t.$update(3,n)}));let i;return{$observeRoot(e){const o=v(g(e)),r=()=>{t.$update(4,o[n])};o.addEventListener("resize",r),r(),i=()=>{o.removeEventListener("resize",r)}},$observeItem:(e,t)=>(s.set(e,t),c.S(e),()=>{s.delete(e),c.I(e)}),$dispose(){i&&i(),c.m()}}},V=(e,t)=>{let r;const n="height",s="width",c=new WeakMap,i=new Set,l=new Set,f=new Map,a=(e,t)=>`${e}-${t}`,u=O((u=>{const d=new Set,$=new Set;for(const{target:o,contentRect:i}of u)if(o.offsetParent)if(o===r)e.$update(4,i[n]),t.$update(4,i[s]);else{const e=c.get(o);if(e){const[t,o]=e,r=a(t,o),c=f.get(r),l=[i[n],i[s]];let u,h;c?(c[0]!==l[0]&&(u=!0),c[1]!==l[1]&&(h=!0)):u=h=!0,u&&d.add(t),h&&$.add(o),(u||h)&&f.set(r,l)}}if(d.size){const t=[];d.forEach((e=>{let r=0;l.forEach((t=>{const n=f.get(a(e,t));n&&(r=o(r,n[0]))})),r&&t.push([e,r])})),e.$update(3,t)}if($.size){const e=[];$.forEach((t=>{let r=0;i.forEach((e=>{const n=f.get(a(e,t));n&&(r=o(r,n[1]))})),r&&e.push([t,r])})),t.$update(3,e)}}));return{$observeRoot(e){u.S(r=e)},$observeItem:(e,t,o)=>(c.set(e,[t,o]),i.add(t),l.add(o),u.S(e),()=>{c.delete(e),u.I(e)}),$resizeCols(o){for(const[t]of o)for(let o=0;o<e.$getItemsLength();o++)f.delete(a(o,t));t.$update(3,o)},$resizeRows(o){for(const[e]of o)for(let o=0;o<t.$getItemsLength();o++)f.delete(a(e,o));e.$update(3,o)},$dispose:u.m}};export{y as ACTION_ITEMS_LENGTH_CHANGE,k as ACTION_START_OFFSET_CHANGE,z as UPDATE_SCROLL_END_EVENT,_ as UPDATE_SCROLL_EVENT,x as UPDATE_VIRTUAL_STATE,V as createGridResizer,L as createGridScroller,q as createResizer,B as createScroller,M as createVirtualStore,U as createWindowResizer,C as createWindowScroller,T as getScrollSize,m as isBrowser,b as isRTLDocument,i as microtask,c as sort};
//# sourceMappingURL=index.mjs.map
